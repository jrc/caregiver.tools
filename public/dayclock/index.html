<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Day Clock - Caregiver.tools</title>
        <link rel="stylesheet" href="../style.css" />
        <style>
            #qrcode-display {
                margin-bottom: 0.5rem;
            }

            .label-url {
                font-size: small;
                word-break: break-word;
                line-height: 1;
            }

            .typeable-url {
                font-size: large;
                word-break: break-word;
                line-height: 1;
            }

            /* ==========================================================================
               CSS-only Tab/Toggle Implementation
               ========================================================================== */

            /* Hide the actual radio buttons */
            .tab-container input[type="radio"] {
                display: none;
            }

            /* Style the container for the buttons (the pill group) */
            .tab-buttons {
                display: flex;
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            /* Style the labels (which act as the buttons/pills) */
            .tab-buttons label {
                border-radius: 4px;
                cursor: pointer;
                font-family: inherit;
                font-size: 1rem;
                line-height: inherit;
                padding: 0.5rem 1rem;

                /* Inactive pill */
                background-color: transparent;
                border: 1px solid transparent;
                color: rgb(0, 123, 255);
            }

            .tab-buttons label:hover {
                color: rgb(0, 86, 179);
            }

            /* Active pill */
            #tab-ios9:checked ~ .tab-buttons label[for="tab-ios9"],
            #tab-ios12:checked ~ .tab-buttons label[for="tab-ios12"] {
                background-color: rgb(0, 123, 255);
                border: 1px solid rgb(0, 123, 255);
                color: white;
            }

            /* Hide all tab content panes by default */
            .tab-pane-css {
                display: none;
                padding-top: 1rem;
            }

            /* Show the content pane associated with the checked radio button */
            #tab-ios9:checked ~ .tab-content-css #content-ios9,
            #tab-ios12:checked ~ .tab-content-css #content-ios12 {
                display: block;
            }
        </style>
    </head>

    <body>
        <nav>
            <a href="../">Caregiver.tools</a>
        </nav>
        <main>
            <!-- Browser compatibility warning -->
            <div id="browser-incompatible" class="alert alert-secondary">
                <h3>üõë Open This Page on a Newer Device</h3>
                <p>
                    To set up and manage a Day Clock, open this page in a newer
                    web browser. The Day Clock itself is designed to run on
                    older devices, but the caregiver interface requires a newer
                    browser.
                </p>
            </div>

            <h1>Day Clock</h1>

            <p>
                Day Clock is a free web app that shows the day, time, and date
                in a way that‚Äôs easy to understand for people with cognitive
                disabilities. It‚Äôs also designed to work on older phones and
                tablets, giving new life to unused devices. Caregivers can
                remotely set a custom message to be displayed on the clock.
            </p>

            <h2>Hardware Requirements</h2>
            <p>
                You need an unused phone or tablet to serve as the dedicated Day
                Clock.
            </p>

            <p>
                Day Clock has been tested on iOS 9, and
                <a href="https://iosref.com/ios"
                    >all iOS devices introduced since 2011 can be upgraded to
                    iOS 9 or later.</a
                >
                To check the version of iOS on a device, go to the Settings app
                &gt; General &gt; About and look for Version.
            </p>
            <p>
                Day Clock may also work on Android and even older Apple iOS
                devices, but it has not been tested. Let me know if you have any
                success.
            </p>

            <h2>Installation</h2>

            <p>
                Perform the steps below on the device that will serve as the Day
                Clock.
            </p>

            <div class="tab-container">
                <input
                    type="radio"
                    id="tab-ios9"
                    name="instruction-tabs"
                    checked
                />
                <input type="radio" id="tab-ios12" name="instruction-tabs" />

                <div class="tab-buttons">
                    <label for="tab-ios9">For iOS 9</label>
                    <label for="tab-ios12">For iOS 12</label>
                </div>

                <div class="tab-content-css">
                    <div id="content-ios9" class="tab-pane-css">
                        <h3>Erase the Device (optional)</h3>
                        <p>
                            It is recommended, but optional, that you completely
                            erase the device, so that no other apps interfere
                            with the operation of the Day Clock.
                        </p>
                        <ol>
                            <li>
                                Go to the Settings
                                <img
                                    src="img/Settings.png"
                                    alt="Settings app icon"
                                    style="height: 1em"
                                />
                                app &gt; General &gt; Reset.

                                <div class="alert alert-warning">
                                    Your device will be erased. Make sure you
                                    have a copy of any data that you want to
                                    keep.
                                </div>

                                Tap ‚ÄúErase All Content and Settings‚Äù, then
                                ‚ÄúErase‚Äù to confirm.
                            </li>
                            <li>
                                Set up the device as a new iPhone/iPad, with no
                                passcode, Apple ID, or Siri:
                                <ul>
                                    <li>
                                        Choose your language, country, and Wi-Fi
                                        network.
                                    </li>
                                    <li>
                                        Tap ‚ÄúEnable Location Services‚Äù
                                        (optional).
                                    </li>
                                    <li>
                                        Tap ‚ÄúPasscode Options‚Äù, then ‚ÄúDon‚Äôt Add
                                        Passcode‚Äù, then ‚ÄúContinue‚Äù.
                                    </li>
                                    <li>Tap ‚ÄúSet up as New iPhone/iPad‚Äù.</li>
                                    <li>
                                        Tap ‚ÄúDon‚Äôt have an Apple ID or forgot
                                        it?‚Äù, then ‚ÄúSet Up Later in Settings‚Äù,
                                        then ‚ÄúDon‚Äôt Use‚Äù.
                                    </li>
                                    <li>
                                        Tap ‚ÄúAgree‚Äù to the Terms and Conditions.
                                    </li>
                                    <li>Tap ‚ÄúTurn On Siri Later‚Äù.</li>
                                    <li>Tap ‚ÄúSend to Apple‚Äù (optional).</li>
                                    <li>
                                        Tap ‚ÄúShare with App Developers‚Äù
                                        (optional).
                                    </li>
                                    <li>Finally, tap ‚ÄúGet Started‚Äù.</li>
                                </ul>
                            </li>
                        </ol>

                        <h3>Prepare the Device</h3>
                        <ol>
                            <li>
                                Go to the Settings
                                <img
                                    src="img/Settings.png"
                                    alt="Settings app icon"
                                    style="height: 1em"
                                />
                                app &gt; General &gt; Accessibility &gt; Guided
                                Access (it‚Äôs near the bottom). Turn on Guided
                                Access.
                            </li>
                            <li>
                                Go to the Settings
                                <img
                                    src="img/Settings.png"
                                    alt="Settings app icon"
                                    style="height: 1em"
                                />
                                app &gt; General &gt; Auto-Lock, and choose
                                Never.
                            </li>
                        </ol>

                        <h3>Install the Day Clock</h3>
                        <ol>
                            <li>
                                <p>
                                    Go to the Safari
                                    <img
                                        src="img/Safari.png"
                                        alt="Safari app icon"
                                        style="height: 1em"
                                    />
                                    app and enter the web address
                                </p>
                                <p class="clock-url typeable-url"></p>
                                <p>
                                    ‚ö†Ô∏é Don‚Äôt share this link. It contains a
                                    secret code that identifies your Day Clock.
                                </p>
                            </li>
                            <li>
                                Tap the Share
                                <img
                                    src="img/Share.png"
                                    alt="iOS share icon"
                                    style="height: 1em"
                                />
                                button, then ‚ÄúAdd to Home Screen‚Äù, then ‚ÄúAdd‚Äù.
                                This installs the Day Clock web app.
                            </li>
                            <li>
                                Press the Home button, then go to the Day Clock
                                app.
                            </li>
                            <li>
                                Triple-click the Home button, then tap Start to
                                enter
                                <a href="https://support.apple.com/en-us/111795"
                                    >Guided Access</a
                                >. Set a Guided Access passcode to keep the
                                device in this mode.
                            </li>
                        </ol>

                        <h3>Put the Day Clock in Place</h3>
                        <ol>
                            <li>
                                Position your Day Clock as desired for the
                                person who will use it. As the device can be
                                confused for a regular phone or tablet, consider
                                using tape or other means to fasten the device
                                in place.
                            </li>
                            <li>
                                Plug in the device and make sure it is charging.
                            </li>
                        </ol>
                    </div>

                    <div id="content-ios12" class="tab-pane-css">
                        <h3>Erase the Device (optional)</h3>
                        <p>
                            It is recommended, but optional, that you completely
                            erase the device, so that no other apps interfere
                            with the operation of the Day Clock.
                        </p>
                        <ol>
                            <li>
                                Go to the Settings
                                <img
                                    src="img/Settings.png"
                                    alt="Settings app icon"
                                    style="height: 1em"
                                />
                                app &gt; General > Reset (or ‚ÄúTransfer or Reset
                                iPhone/iPad‚Äù).

                                <div class="alert alert-warning">
                                    Your device will be erased. Make sure you
                                    have a copy of any data that you want to
                                    keep.
                                </div>

                                Tap ‚ÄúErase All Content and Settings‚Äù, then
                                ‚ÄúErase‚Äù to confirm.
                            </li>
                            <li>
                                Set up the iPhone/iPad as a new device, without
                                a passcode, Apple ID, or Siri:
                                <ul>
                                    <li>
                                        Choose your language, country, and Wi-Fi
                                        network.
                                    </li>
                                    <li>???</li>
                                </ul>
                            </li>
                        </ol>

                        <h3>Prepare the Device</h3>
                        <ol>
                            <li>
                                Go to the Settings
                                <img
                                    src="img/Settings.png"
                                    alt="Settings app icon"
                                    style="height: 1em"
                                />
                                app &gt; General &gt; Accessibility &gt; Guided
                                Access (it‚Äôs near the bottom).
                            </li>
                            <ul>
                                <li>Turn on Guided Access.</li>
                                <li>Turn on Mirror Display Auto-Lock.</li>
                            </ul>
                            <li>
                                Go to the Settings
                                <img
                                    src="img/Settings.png"
                                    alt="Settings app icon"
                                    style="height: 1em"
                                />
                                app &gt; General &gt; Auto-Lock, and choose
                                Never.
                            </li>
                        </ol>

                        <h3>Install the Day Clock</h3>
                        <ol>
                            <li>
                                <p>
                                    Open the Camera
                                    <img
                                        src="img/Camera.png"
                                        alt="Camera app icon"
                                        style="height: 1em"
                                    />
                                    app and scan the code below:
                                </p>
                                <div id="qrcode-display"></div>
                                <p class="clock-url label-url"></p>
                                <p>
                                    ‚ö†Ô∏é Don‚Äôt share this link. It contains a
                                    code that identifies your Day Clock.
                                </p>
                            </li>
                            <li>
                                Tap the Share
                                <img
                                    src="img/Share.png"
                                    alt="Share button icon"
                                    style="height: 1em"
                                />
                                button, then ‚ÄúAdd to Home Screen‚Äù, then ‚ÄúAdd‚Äù.
                                This installs the Day Clock web app.
                            </li>
                            <li>
                                Go to the Home screen, then go to the Day Clock
                                app.
                            </li>
                            <li>
                                Triple-click the Side or Home button, then tap
                                Start to enter
                                <a href="https://support.apple.com/en-us/111795"
                                    >Guided Access</a
                                >. Set a Guided Access passcode to keep the
                                device in this mode.
                            </li>
                        </ol>

                        <h3>Put the Day Clock in Place</h3>
                        <ol>
                            <li>
                                Position your Day Clock as desired for the
                                person who will use it. As the device can be
                                confused for a regular phone or tablet, consider
                                using tape or other means to fasten the device
                                in place.
                            </li>
                            <li>
                                Plug in the device and make sure it is charging.
                            </li>
                        </ol>
                    </div>
                </div>
            </div>

            <h2>Customize Your Day Clock</h2>
            <p>
                Open the secret link below and bookmark it. This is the only way
                that you, the caregiver, can customize your Day Clock later.
            </p>
            <p>
                <a href="" id="admin-url" class="typeable-url"></a>
            </p>
            <p>
                ‚ö†Ô∏é Don‚Äôt share this link publicly. It contains a code that
                identifies this Day Clock.
            </p>
        </main>
    </body>

    <script src="qrcode.min.js"></script>
    <script src="eff_short_wordlist_1.js"></script>
    <script src="script.js"></script>
    <script>
        // Browser compatibility check
        (function () {
            "use strict";

            function checkBrowserCompatibility() {
                var userAgent = navigator.userAgent;
                var isCompatible = false;

                // Check Safari version (including iOS Safari)
                if (
                    userAgent.indexOf("Safari") !== -1 &&
                    userAgent.indexOf("Chrome") === -1
                ) {
                    var safariMatch = userAgent.match(/Version\/(\d+)\.(\d+)/);
                    if (safariMatch) {
                        var majorVersion = parseInt(safariMatch[1]);
                        var minorVersion = parseInt(safariMatch[2]);
                        // Safari 10.1+ required for async/await
                        isCompatible =
                            majorVersion > 10 ||
                            (majorVersion === 10 && minorVersion >= 1);
                    }
                }

                // Check Chrome version
                if (userAgent.indexOf("Chrome") !== -1) {
                    var chromeMatch = userAgent.match(/Chrome\/(\d+)/);
                    if (chromeMatch) {
                        var chromeVersion = parseInt(chromeMatch[1]);
                        // Chrome 55+ required for async/await
                        isCompatible = chromeVersion >= 55;
                    }
                }

                // Hide warning if browser is compatible
                var warningElement = document.getElementById(
                    "browser-incompatible"
                );
                if (isCompatible) {
                    warningElement.style.display = "none";
                }

                return isCompatible;
            }

            // Run compatibility check immediately
            if (!checkBrowserCompatibility()) {
                // Browser is not compatible, don't run the main script
                return;
            }

            // Browser is compatible, run the main script
            (async () => {
                "use strict";

                // --- DOM Elements ---
                const qrcodeDisplay = document.getElementById("qrcode-display");
                const clockUrlElements =
                    document.querySelectorAll(".clock-url");
                const adminUrlElement = document.getElementById("admin-url");

                // --- Cookie Handling ---
                function getCookie(name) {
                    const nameEQ = name + "=";
                    const ca = document.cookie.split(";");
                    for (let i = 0; i < ca.length; i++) {
                        let c = ca[i];
                        while (c.charAt(0) === " ")
                            c = c.substring(1, c.length);
                        if (c.indexOf(nameEQ) === 0)
                            return c.substring(nameEQ.length, c.length);
                    }
                    return null;
                }

                function setCookie(name, value, days) {
                    let expires = "";
                    if (days) {
                        const date = new Date();
                        date.setTime(
                            date.getTime() + days * 24 * 60 * 60 * 1000
                        );
                        expires = "; expires=" + date.toUTCString();
                    }
                    document.cookie =
                        name + "=" + (value || "") + expires + "; path=/";
                }

                // --- Initial Page Load ---
                const cookieName = "dayclock_id";
                let clockId = getCookie(cookieName);

                if (!clockId) {
                    // Generate a unique clock ID by checking for collisions
                    clockId =
                        await window.CaregiverTools.generateUniqueClockId();
                    setCookie(cookieName, clockId, 365); // Store for a year
                }

                let currentUrl = window.location.href;
                if (currentUrl.endsWith("/")) {
                    currentUrl += "index";
                }
                const baseClockUrl = currentUrl.replace("/index", "/clock");
                const fullClockUrl = baseClockUrl + "?id=" + clockId;
                clockUrlElements.forEach((element) => {
                    element.textContent = fullClockUrl;
                });

                qrcodeDisplay.innerHTML = "";
                new QRCode(qrcodeDisplay, {
                    text: fullClockUrl,
                    height: 128,
                    width: 128
                });

                const fullAdminUrl = fullClockUrl.replace("/clock", "/admin");
                adminUrlElement.textContent = fullAdminUrl;
                adminUrlElement.href = fullAdminUrl;
            })();
        })();
    </script>

    <script>
        window.goatcounter = {
            path: function (p) {
                return location.host + p;
            }
        };
    </script>
    <script
        data-goatcounter="https://jrcplus.goatcounter.com/count"
        async
        src="//gc.zgo.at/count.js"
    ></script>
</html>
